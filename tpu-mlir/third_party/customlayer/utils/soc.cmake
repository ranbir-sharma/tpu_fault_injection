if ("$ENV{CUSTOM_LAYER_CHIP_ARCH}" STREQUAL "bm1684x")
  set(CMAKE_C_COMPILER $ENV{CROSS_TOOLCHAINS_DIR}/gcc-arm-10.3-2021.07-x86_64-aarch64-none-linux-gnu/bin/aarch64-none-linux-gnu-gcc)
  set(CMAKE_ASM_COMPILER aarch64-linux-gnu-gcc)
  set(CMAKE_CXX_COMPILER aarch64-linux-gnu-g++)
  set(KM_CUSTOM_1684X_SOC_OUTPUT_FILE bm1684x_kernel_module_custom_soc)
  add_library(${KM_CUSTOM_1684X_SOC_OUTPUT_FILE} SHARED ${SRC_FILES})
  target_link_libraries(${KM_CUSTOM_1684X_SOC_OUTPUT_FILE} -Wl,--whole-archive $ENV{TPUC_ROOT}/lib/libbm1684x_kernel_module.a -Wl,--no-whole-archive m)
  set_target_properties(${KM_CUSTOM_1684X_SOC_OUTPUT_FILE} PROPERTIES PREFIX "lib" SUFFIX ".so" COMPILE_FLAGS "-fPIC" LINK_FLAGS "-shared")
  install(TARGETS ${KM_CUSTOM_1684X_SOC_OUTPUT_FILE} LIBRARY DESTINATION lib)
elseif ("$ENV{CUSTOM_LAYER_CHIP_ARCH}" STREQUAL "bm1688")
  set(CMAKE_C_COMPILER $ENV{CROSS_TOOLCHAINS_DIR}/Xuantie-900-gcc-linux-5.10.4-glibc-x86_64-V2.6.1/bin/riscv64-unknown-linux-gnu-gcc)
  set(CMAKE_ASM_COMPILER $ENV{CROSS_TOOLCHAINS_DIR}/gcc-arm-10.3-2021.07-x86_64-aarch64-none-linux-gnu/bin/aarch64-none-linux-gnu-gcc)
  set(CMAKE_CXX_COMPILER $ENV{CROSS_TOOLCHAINS_DIR}/gcc-arm-10.3-2021.07-x86_64-aarch64-none-linux-gnu/bin/aarch64-none-linux-gnu-g++)
  set(KM_CUSTOM_1688_SOC_OUTPUT_FILE bm1688_kernel_module_custom_soc)
  add_library(${KM_CUSTOM_1688_SOC_OUTPUT_FILE} SHARED ${SRC_FILES})
  target_link_libraries(${KM_CUSTOM_1688_SOC_OUTPUT_FILE} -Wl,--whole-archive $ENV{TPUC_ROOT}/lib/libbmtpulv60_kernel_module.a -Wl,--no-whole-archive m)
  set_target_properties(${KM_CUSTOM_1688_SOC_OUTPUT_FILE} PROPERTIES PREFIX "lib" SUFFIX ".so" COMPILE_FLAGS "-fPIC" LINK_FLAGS "-shared")
  install(TARGETS ${KM_CUSTOM_1688_SOC_OUTPUT_FILE} LIBRARY DESTINATION lib)
else()
  message(FATAL_ERROR "Unknown chip arch: " $ENV{CUSTOM_LAYER_CHIP_ARCH})
endif()
